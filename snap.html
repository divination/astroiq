
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <title>Zodiac</title>
<style>

@import url('/css/style.css') screen;

#snap-pane,
#main {
    position: relative;
    margin: 0 auto;
}
#snap-pane {
    max-height: 92vh;
}

#snap-pane svg image.body {
    /*transition: all 5ms ease-in;*/
    transform-origin: 50% 50% 50%;    
}

</style>


    <script
  src="//code.jquery.com/jquery-3.1.1.min.js"
  integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
  crossorigin="anonymous"></script>


</head>
<body>

<header id="navbar">
    <h1>astroIQ Demo</h1>
    <nav class="horizontal"><ul>
        <li><a href="/">Command Test</a></li>   
        <li><a href="/zodiac">Zodiac Demo</a></li>
        <li><a href="/snap">Snap Demo</a></li>
    </ul></nav>
</header>

<div id="main">

    <object id="snap-pane" class="snap-pane">
        <?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 1440 1440" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="zodiac-svg">
   
</svg>

    </object>


</div>
<script data-source="internal" type="text/javascript" src="/js/snap/dist/snap.svg-min.js"></script>
<script data-source="internal" type="text/javascript">

(function($) {
    $( document ).ready(function() {

        var astroDisc = {
            snap: null,
            radius: 360,
            element: '#zodiac-svg',
            houses: [0,30,60,90,120,150,180,210,240,270,300,330],
            bodies: {},
            addSegment: function(fillColor,startDeg,endDeg,radius) {
                if (!endDeg) {
                    endDeg = 0;
                }
                if (!startDeg) {
                    startDeg = 0;
                }

                var r = this.radius, ps = [r,(0-(r * (5/12))),r,r,((r*2) + (r * (5/12))),r],
                    adj = Math.pow((3/Math.PI),1.125),
                    s1 = Math.abs(ps[1] - ps[3]),
                spanDeg = endDeg - startDeg, frac = spanDeg / 90, sub = s1 * (1-frac) * adj;
                ps[4] -= sub;
                ps[5] -= sub;
                var bigCircle = this.snap.circle(r,r,r).attr({fill:fillColor}),
                    triangle = this.snap.polygon(ps).attr({fill: "white","stroke-width":0}); 

                bigCircle.attr({
                    mask: triangle,
                    transform: 'rotate('+(endDeg-spanDeg) +'deg)'
                });
                
            },

            drawDiscs: function() {
                var r = this.radius, th = 1;
                for (var i=0; i < 180;i++) {
                    th = i%5==0? 3 : 1;
                    this.snap.line(r, 0, r, (r*2)).attr({
                        "stroke":"black",
                        "stroke-width": th +"px",
                        "transform-origin": "0 0",
                        transform: "rotate("+i+"deg)"
                    });
                }
                this.snap.circle(r,r,(r * 0.75 )).attr({fill:'#110066'});
            },

            housesToSegments: function() {
                this.houses.push((360-this.houses[0]));
                var cls = ['#ff0000','#999900','#00ff00','#009999','#0000ff','#990099'];
                var index=0,start, end;
                for (d in this.houses) {
                    if (start == null) {
                        start = this.houses[d];
                    } else {
                        end = this.houses[d];
                    }
                    if (end != null && start !=null) {
                         this.addSegment(cls[(index%cls.length)],start,end);
                         start = end;
                         end = null;
                         index++;
                    }
                }
            },

            placeBody: function(bodyName,x,y) {
                var r= this.radius, xd = r - ((r * 0.75) * x), yd = r - ((r * 0.75) * y);
                return this.snap.image('/svgs/bodies/'+bodyName+'-sign.svg',xd,yd,(r/12),(r/12)).attr('class','body ' + bodyName);
            },

            positionBody: function(bodyEl,x,y) {
                var r= this.radius, xd = r - ((r * 0.75) * x), yd = r - ((r * 0.75) * y);
                bodyEl.attr({
                    x: xd,
                    y: yd
                });
            },

            init: function(radius,houses) {
                this.snap = Snap('#zodiac-svg');
                if (radius) {
                    if (typeof radius == 'number') {
                        this.radius = radius;
                    }
                }
                if (houses) {
                    if (houses instanceof Array) {
                        this.houses = houses;
                    }
                }
                this.housesToSegments();
                this.drawDiscs();
                this.bodies.sun = this.placeBody('sun',0.1,0.-.1);
                this.bodies.moon = this.placeBody('moon',0.6,0.-.6);
                this.bodies.mercury = this.placeBody('mercury',0.25,0.25);
                this.bodies.venus = this.placeBody('venus',0.1,-0.15);
                this.bodies.marse = this.placeBody('mars',0.35,0.15);
                this.bodies.jupiter = this.placeBody('jupiter',0.5,0.5);
                this.bodies.saturn = this.placeBody('saturn',-0.7,0.3);
                this.bodies.neptune = this.placeBody('neptune',-0.4,-0.23);
                var rd = 180/Math.PI, degs=45, pos=.9;
                this.bodies.uranus = astroDisc.placeBody('uranus',Math.sin(degs/rd),Math.cos(45/degs));
                setInterval(function() {
                    degs += .05;
                    var mx = Math.cos(degs/rd),
                    my = Math.sin(degs/rd);
                    // pos = 1 - ((degs%45) / 1000);
                    my *= pos;
                    mx *= pos;
                    astroDisc.positionBody(astroDisc.bodies.uranus,mx,my);
                },5); 
            }
        }

        
        
        astroDisc.init(720);

   
    });
})(jQuery);

</script>

</body>
</html>